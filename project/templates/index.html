{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-10 col-lg-8 mx-auto">

        {# --- LOGGED IN VIEW: Show the writing feed --- #}
        {% if current_user.is_authenticated %}
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="gradient-text">Writer's Feed</h1>
            <a href="{{ url_for('main.create_post') }}" class="btn btn-success">Write Something New</a>
        </div>

        {% if posts %}
        {% for post in posts %}
        <div class="glass-card mb-4 bg-white bg-opacity-50">
            <h2 class="h4 fw-bold mb-1">{{ post.title }}</h2>
            <p class="text-muted small mb-3">
                By <strong>{{ post.author.username }}</strong>
                on {{ post.timestamp.strftime('%B %d, %Y') }}
            </p>
            <hr class="divider my-3">
            <p class="post-body">{{ post.body }}</p>
            <!-- Only show author name if it's different/extra, or just clean it up -->
            {% if post.author_name %}
            <p class="text-end text-muted fst-italic mt-3 mb-0">- {{post.author_name}}</p>
            {% endif %}
        </div>
        {% endfor %}
        {% else %}
        <div class="glass-card text-center p-5">
            <h3>The feed is empty.</h3>
            <p class="text-muted">Be the first one to share a story!</p>
            <a href="{{ url_for('main.create_post') }}" class="btn btn-auth mt-3">Create Post</a>
        </div>
        {% endif %}

        {# --- GUEST VIEW: Show the welcome message and login button --- #}
        {% else %}
        <div class="glass-card text-center py-5 px-4">
            <h1 class="display-4 fw-bold gradient-text mb-3">Share Your Stories with the World</h1>
            <p class="lead text-muted mb-4">A dedicated space for bloggers, poets, and article writers.</p>
            <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                <a href="{{ url_for('main.login_page') }}" class="btn btn-auth btn-lg px-5 gap-3">Login to Write</a>
                <a href="{{ url_for('main.register_page') }}" class="btn btn-outline-secondary btn-lg px-5">Join Hub</a>
            </div>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}